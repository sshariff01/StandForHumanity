octoplace_com.m.main.loadModules(["data","util"],function(){octoplace_com.m.pane_float=function(){function l(c){var a=0;$(window).off("resize.pane_float");$(window).on("resize.pane_float",function(b){a||(a=setTimeout(function(){e(c);a=0},17))})}function e(c){if(!h){var a=$(window).width(),b=$(c).outerWidth();if($(c).offset().left+b>a||!$(c).is(".user_positioned"))a-=b,$(c).css("left",a+"px")}}var d=octoplace_com,g={};d.m.main.loadCss("pane_float");var h=!1;g.create=function(){$("body").is(".bookmarklet")&&
(h=!0)};g.init=function(){var c={},a={};c.dock=function(){$(a.pane).removeClass("user_positioned");e(a.pane)};c.hide=function(){c.onDestroy&&(c.onDestroy(),delete c.onDestroy);$(a.pane).addClass("animate_out");setTimeout(function(){$(a.pane).remove()},150);$(window).off("resize.pane_float")};c.show=function(b){"undefined"==typeof b&&(b={});$(a.pane).removeClass("hidden");$(a.pane).addClass("animate_in");setTimeout(function(){$(a.pane).removeClass("animate_in")},300);l(a.pane);e(a.pane);c.showHeader(b.cancel_text);
b.body&&($(a.body).append(b.body),setTimeout(function(){$(b.body).find(".focus_me").first().focus()},500),$(a.body).css({"background-color":$(b.body).css("background-color")}));b.footer?($(a.footer).append(b.footer),$(a.pane).removeClass("no_footer")):$(a.pane).addClass("no_footer");b.onDestroy&&(c.onDestroy=b.onDestroy);"undefined"!=typeof b.left&&($(a.pane).addClass("user_positioned"),$(a.pane).css("left",b.left+"px"),e(a.pane))};c.showHeader=function(b){b?(a.hide_control=d.m.main.makeButton(b),
$(a.hide_control).addClass("pane_float_hide_control text_only small")):(a.hide_control=d.m.main.makeButton("CANCEL"),$(a.hide_control).addClass("pane_float_hide_control text_only gray small"));$(a.header).append(a.hide_control);$(a.hide_control).on("click",function(a){a.preventDefault();c.hide()});if(!$("body").is(".bookmarklet")){a.drag_bar=$('<div class="pane_float_drag_bar"></div>');$(a.header).append(a.drag_bar);a.dock_control=d.m.main.makeButton("DOCK");$(a.dock_control).addClass("pane_float_dock_control text_only gray small");
$(a.header).append(a.dock_control);$(a.dock_control).on("click",function(a){a.preventDefault();c.dock()});var m=function(b){var c=$(a.pane).offset().left;$(a.pane).addClass("user_positioned");var k=b.x;$("body").on("mousemove.pane_float_drag",function(f){f=d.m.util.getEventPosition(f.originalEvent);k!=f.x&&(k=f.x,f=c+(f.x-b.x),$(a.pane).css("left",f+"px"),e(a.pane))})};$(a.drag_bar).on("mousedown.pane_float_drag",function(a){a.preventDefault();var b=d.m.util.getEventPosition(a.originalEvent);$("body").off("mousemove.pane_float_drag");
$("body").on("mousemove.pane_float_drag",function(a){a=d.m.util.getEventPosition(a.originalEvent).x-b.x;5<Math.abs(a)&&($("body").off("mousemove.pane_float_drag"),m(b))});$("body").one("mouseup.pane_float_drag",function(a){$("body").off("mousemove.pane_float_drag")})})}};a.pane=d.m.main.makePane("pane_float");$(a.pane).addClass("hidden");$("body").append(a.pane);a.header=$('<div class="pane_float_header"></div>');$(a.pane).append(a.header);a.body=$('<div class="pane_float_body"></div>');$(a.pane).append(a.body);
a.footer=$('<div class="pane_float_footer"></div>');$(a.pane).append(a.footer);$(a.body).on("mousewheel",function(b,c){var d=$(a.body)[0].scrollHeight,e=$(a.body).height();d!=e&&(this.scrollTop===d-e&&0>c||0===this.scrollTop&&0<c)&&b.preventDefault()});return c};return g}()});
